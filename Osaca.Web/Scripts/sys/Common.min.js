$.fn.afterLoadDatawithdata=function(){};$.fn.afterLoadData=function(){};$.fn.afterSave=function(){};$.fn.beforeSave=function(){return!0};var commonManger=function(){var h=function(n,t,i){$(".modal-header h3").html('<i class="icon-edit"><\/i> '+n+"");$("#"+i).attr("data-operation",t);$("#"+i).modal({show:!0})},c=function(n,r,u,f,e){var o=i(r);o&&dataService.callAjax("Post",JSON.stringify(f),u,e,t)},l=function(n){$("#"+n+" .modal-body").find("input, textarea, button, select").attr("disabled","disabled")},a=function(n){$("#"+n+" .modal-body").find("input, textarea, button, select").removeAttr("disabled")},n=function(n,t){$(".gritter-item-wrapper").remove();$.gritter.add({class_name:"gritter-warning gritter-light",title:n,text:t,sticky:!1})},t=function(t,i,r){var u=i+": "+r,f=JSON.parse(t.responseText).Message;n(u,f);console.log(u+": "+f)},i=function(n){var t=$("#"+(n?n:"aspnetForm"));return t.valid()},v=function(n){var t=0,i;$(".dataTables_filter input").unbind("keypress keyup").bind("keypress keyup",function(){var r=$(this);t=0;i||(i=setInterval(function(){if(t>=3){clearInterval(i);i="";var u=$(r).val();n.fnFilter(u);t=0}t++},200))})},y=function(n){$("#"+n+"").find("input:not(.noreset)").each(function(){if($(this).attr("id")&&!$(this).hasClass("hasfunction")&&!$(this).hasClass("noreset")){var t=$(this).attr("id"),n=$(this).prop("type");n=="text"||n=="number"||n=="email"||n=="date"?$(this).val(value=""):n=="checkbox"?$(this).prop("checked",!0):n=="hidden"?$(this).val(value="0"):n=="textarea"&&($(this).hasClass("textareaSpecial")?CKEDITOR.instances[t].setData("<p><\/p>"):$(this).val(value=""))}});$("#"+n+"").find("select:not(.noreset)").each(function(){if($(this).attr("name")){var n=$(this).attr("id"),t=$(this).prop("type");t=="select-one"&&($("#"+n).val(""),$("#"+n).hasClass("chzn-select")&&($(".chzn-select").val(""),$(".chzn-select").trigger("chosen:updated")))}});$("#"+n+" textarea:not(.noreset)").val("")},p=function(n,t){var i=[];$("#"+t).find("select:not(.notfill)").each(function(){var n=$(this).attr("id");n&&i.push(n)});$.each(n,function(t,r){if(n.tbl_name!=150&&n.tbl_name!=160)for(var u=0;u<i.length;u++)r.tbl_name==u&&($("#"+i[u]+"").append("<option value='"+r.ID+"'>"+r.Name+"<\/option>"),$("#"+i[u]+"").hasClass("chzn-select")&&$("#"+i[u]+"").chosen().trigger("chosen:updated").trigger("liszt:updated"))})},w=function(i,r,u){var f=[],e=[],o=tableName+"_Delete";$("#"+deleteModalDialog).find(".removeField").text().toLowerCase().indexOf(",")>=0?f=$("#"+deleteModalDialog).find(".removeField").text().split(","):f.push($("#"+deleteModalDialog).find(".removeField").text());pKey.toLowerCase().indexOf(",")>=0?e=pKey.split(","):e.push(pKey);DTO={actionName:o,names:e,values:f};i=$("#"+i);dataService.callAjax("Post",JSON.stringify(DTO),sUrl+"SaveData",function(t){$(i).modal("hide");t.d.Status?u(t):n("خطأ بالحذف:","خطأ أثناء الحذف "+t.d.message)},t)},b=function(i,r,u,f,e,o){var s=[],h=[],c=f+"_Delete";String(o).indexOf(",")>=0?s=o.split(","):s.push(o);String(e).indexOf(",")>=0?h=e.split(","):h.push(e);DTO={Ids:s,ActionName:c,Parm_name:h};i=$("#"+i);dataService.callAjax("Post",JSON.stringify(DTO),mainServiceUrl+"Delete_Data",function(t){$(i).modal("hide");t.d.Status?r(t):n("لم تتم عملية الحذف",t.d.message)},t)},k=function(i,r,u,f,e,o){var s=[],h=[],c=f+"_Delete";s.push(o);h.push(e);DTO={Ids:s,ActionName:c,Parm_name:h};i=$("#"+i);dataService.callAjax("Post",JSON.stringify(DTO),mainServiceUrl+"Delete_Data",function(t){$(i).modal("hide");t.d.Status?r(t):n("لم تتم عملية الحذف",t.d.message)},t)},d=function(n,t){$("#"+t+"").find("input,select,textarea,label").each(function(){var t,i;$(this).attr("id")&&($(this).hasClass("notneed")||(ElementId=$(this).attr("id"),t=$(this).prop("type"),(t!="undefined"||t!="")&&(t=="text"||t=="hidden"||t=="number"||t=="email"||t=="date"||t=="textarea"?$(this).hasClass("textareaSpecial")?CKEDITOR.instances[ElementId].setData(n[ElementId]):$(this).hasClass("date-picker")?$(this).val(f(n[ElementId])):$(this).hasClass("money")?$(this).val(numeral(n[ElementId]).format("0.00")):(i=n[ElementId]+"",i.toLowerCase().indexOf("date(")>0?$(this).val(u(n[ElementId])):$(this).val(n[ElementId])):t=="select-one"&&$("#"+ElementId).hasClass("showvalue")?$("#"+ElementId+" option").filter(function(){return $(this).text()===n[ElementId]}).attr("selected","selected"):t!="select-one"||$("#"+ElementId).hasClass("showvalue")?t=="checkbox"?$(this).prop("checked",n[ElementId]):$(this).is("label")&&$("#"+ElementId+"").text(n[ElementId]):($("#"+ElementId).val(n[ElementId]),$("#"+ElementId).hasClass("chzn-select")&&$("#"+ElementId).chosen().trigger("chosen:updated").trigger("liszt:updated")))))});$.fn.afterLoadData();$.fn.afterLoadDatawithdata(n)},g=function(){var t=mainServiceUrl+"load_goalble_list",i={funName:tableName+"_Properties"};dataService.callAjax("Post",JSON.stringify(i),t,function(n){var t=JSON.parse(n.d);bindListsOnForm(t,formName);bindListsOnForm(t,detailsForm)},function(t,i,r){var u=i+": "+r,f=JSON.parse(t.responseText).Message;n("danger",u,f)})},nt=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},tt=function(){return today_date=new Date,today_Date_Str=(today_date.getDate()<10?"0":"")+(today_date.getMonth()<9?"0":"")+String(today_date.getMonth()+1)+""+String(today_date.getDate()+""+today_date.getFullYear())},it=function(n){var t=[];return $("#"+n).find("input,select,textarea").each(function(){$(this).attr("id")&&($(this).hasClass("notneed")||($(this).hasClass("notshow")?t.push("hide"+$(this).attr("id")):t.push($(this).attr("id"))))}),t},rt=function(n){var t=[];return $("#"+n+"").find("input,select,textarea").each(function(){$(this).attr("id")&&($(this).hasClass("notneed")||$(this).hasClass("notsave")||t.push($(this).attr("id")))}),t},ut=function(n,i,u,f,e,o,s,h){var c=[],l=[],a=r(i),v;l=a[0];c=a[1];v={values:c,actionName:s,Parm_names:l,fieldsDetails:e,valuesDetails:o,flage:h};dataService.callAjax("Post",JSON.stringify(v),mainServiceUrl+"SaveDataMasterDetails",function(n){commonManger.showMessage("Data saved:",n.d.message);$.fn.afterSave(c);u(n)},t)},r=function(n){var t=[],i=[],r=[],u="";return console.log(n),$("#"+n).find("input,select,textarea").each(function(){var n,r;$(this).attr("id")&&($(this).hasClass("notneed")||(u=$(this).attr("id"),n=$(this).prop("type"),(n!="undefined"||n!="")&&(n=="text"||n=="hidden"||n=="number"||n=="email"||n=="date"||n=="tel"?$(this).hasClass("date-picker")?(t.push(e($(this).val())),i.push($(this).attr("id"))):(t.push($(this).val()),i.push($(this).attr("id"))):n=="hidden"?($(this).val()==""?t.push("0"):t.push($(this).val()),i.push($(this).attr("id"))):n=="select-one"?(t.push($(this).find("option:selected").val()),i.push($(this).attr("id"))):n=="checkbox"?($(this).prop("checked",function(n,i){t.push(i)}),i.push($(this).attr("id"))):n=="textarea"&&($(this).hasClass("textareaSpecial")?(r=CKEDITOR.instances.Details.getData(),t.push(r),i.push($(this).attr("id"))):(t.push($(this).val()),i.push($(this).attr("id")))))))}),r.push(i,t),r},ft=function(u,f,e){var o,l;if($.fn.beforeSave()){var s=[],h=[],c=r(formName),a=tableName+"_Save";h=c[0];s=c[1];o={actionName:a,names:h,values:s};console.log(o);u=$("#"+u);l=i(f);l&&dataService.callAjax("Post",JSON.stringify(o),sUrl+"saveData",function(t){$(u).modal("hide");t.d.Status?e(t):n("Error",t.d.message);commonManger.ResetControls(formName)},t)}},et=function(u,f,e,o,s,h,c){var l=[],a=[],v=r(f),y;a=v[0];l=v[1];DTO={values:l,actionName:s,Parm_names:a,flage:h};u=$("#"+u);y=i(f);y?dataService.callAjax("Post",JSON.stringify(DTO),mainServiceUrl+"saveData",function(n){n=n.d;$(u).modal("hide");n.Status?(e(n),c(n.serializdata),commonManger.showMessage("Saved:","Data saved:")):commonManger.showMessage("Error",n.message);commonManger.ResetControls(f)},t):($(u).modal("hide"),n("Fields required","Please fillout mandatory fields."))},ot=function(){commonManger.showMessage("Data deleted.","Data has been deleted..");$("#listItems").dataTable().fnDraw()},st=function(n){n=n.d;n.Status?(commonManger.showMessage("Data saved.","Data has been saved.."),$("#listItems").dataTable().fnDraw()):commonManger.showMessage("Data not saved.","Error:"+n.messages)},ht=function(n){return n!==undefined&&n!==null&&n.length>0?n.replace(/[^\d.]/g,""):0},ct=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},lt=function(n){return $(n).text()},u=function(n){if(n==null)return"";var t=new Date(parseInt(n.substr(6)));return t.getDate()+"-"+t.getMonth()+1+"-"+t.getFullYear()},f=function(n){if(n===null)return"";return moment(n).format("DD-MM-YYYY")},e=function(n,t,i){if(!n||n=="")return"";t=t?t:"D-M-YYYY";i=i?i:"MM-DD-YYYY";var r=moment(n,t);return r.format(i)},at=function(n,t,i){return t=t||".",i=i||2,n.toLocaleString().split(t)[0]+t+n.toFixed(i).split(t)[1]},vt=function(n){$("div.page-header h1 small").remove();$("div.page-header h1").append($(" <small>"+n+"<\/small>"))},yt=function(n,t){var i=$("#"+t).DataTable({sDom:"<'row'>t<'row'>",bDestroy:!0,bLengthChange:!1,bFilter:!1,searching:!1,retrieve:!0,paging:!1,data:n})},pt=function(n,t,i){var f=s(n.d),u=f.list,r=f.list1,e;r=r?$.map(r,function(n){return n}):[0];e={sEcho:t?t:0,iTotalRecords:r[0],iTotalDisplayRecords:r[0],aaData:$.isArray(u)?u:$.makeArray(u)};i(e)},o=function(n){var t=$.parseXML(n);return $.xml2json(t)},s=function(n){var t=LZString.decompressFromUTF16(n);return o(t)},wt=function(){$("#sidebar").add("menu-min");window.print()};return{showPopUpDialog:h,doWork:c,showMessage:n,searchData:v,applyValidation:i,disableAllFormElements:l,enableAllFormElements:a,ResetControls:y,Filllist:p,getDataForUpdate:d,getUrlVars:nt,returnFiledsNames:it,returnFiledsNamesToSave:rt,SaveDataMasterDetails:ut,Returncontrolsval:r,getCurrentDate:tt,saveData:et,saveDefaultData:ft,deleteDefaultData:w,deleteData:b,getNumbersFromString:ht,getQueryStrs:ct,getStringFromHTML:lt,errorException:t,formatJSONDate:u,formatCurrency:at,showOptionPrintTitle:vt,deleteMultipleData:k,successDeleted:ot,formatJSONDateCal:f,successSaved:st,fillLists:g,populateDataTable:yt,setData2Grid:pt,comp2json:s,xml2Json:o,printPage:wt,dateFormat:e}}();