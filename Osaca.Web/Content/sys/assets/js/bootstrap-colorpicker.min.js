!function(n){var r=function(n){this.value={h:1,s:1,b:1,a:1};this.setColor(n)},i,t;r.prototype={constructor:r,setColor:function(i){i=i.toLowerCase();var r=this;n.each(t.stringParsers,function(n,u){var e=u.re.exec(i),f=e&&u.parse(e),o=u.space||"rgba";if(f)return r.value=o==="hsla"?t.RGBtoHSB.apply(null,t.HSLtoRGB.apply(null,f)):t.RGBtoHSB.apply(null,f),!1})},setHue:function(n){this.value.h=1-n},setSaturation:function(n){this.value.s=n},setLightness:function(n){this.value.b=1-n},setAlpha:function(n){this.value.a=parseInt((1-n)*100,10)/100},toRGB:function(n,t,i,r){n||(n=this.value.h,t=this.value.s,i=this.value.b);n*=360;var e,o,s,f,u;return n=n%360/60,u=i*t,f=u*(1-Math.abs(n%2-1)),e=o=s=i-u,n=~~n,e+=[u,f,0,0,f,u][n],o+=[f,u,u,f,0,0][n],s+=[0,0,f,u,u,f][n],{r:Math.round(e*255),g:Math.round(o*255),b:Math.round(s*255),a:r||this.value.a}},toHex:function(n,t,i,r){var u=this.toRGB(n,t,i,r);return"#"+(16777216|parseInt(u.r)<<16|parseInt(u.g)<<8|parseInt(u.b)).toString(16).substr(1)},toHSL:function(n,t,i,r){n||(n=this.value.h,t=this.value.s,i=this.value.b);var e=n,u=(2-t)*i,f=t*i;return f/=u>0&&u<=1?u:2-u,u/=2,f>1&&(f=1),{h:e,s:f,l:u,a:r||this.value.a}}};i=function(i,r){this.element=n(i);var u=r.format||this.element.data("color-format")||"hex";if(this.format=t.translateFormats[u],this.isInput=this.element.is("input"),this.component=this.element.is(".color")?this.element.find(".add-on"):!1,this.picker=n(t.template).appendTo("body").on("mousedown",n.proxy(this.mousedown,this)),this.isInput)this.element.on({focus:n.proxy(this.show,this),keyup:n.proxy(this.update,this)});else if(this.component)this.component.on({click:n.proxy(this.show,this)});else this.element.on({click:n.proxy(this.show,this)});(u==="rgba"||u==="hsla")&&(this.picker.addClass("alpha"),this.alpha=this.picker.find(".colorpicker-alpha")[0].style);this.component?(this.picker.find(".colorpicker-color").hide(),this.preview=this.element.find("i")[0].style):this.preview=this.picker.find("div:last")[0].style;this.base=this.picker.find("div:first")[0].style;this.update()};i.prototype={constructor:i,show:function(t){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();n(window).on("resize",n.proxy(this.place,this));this.isInput||t&&(t.stopPropagation(),t.preventDefault());n(document).on({mousedown:n.proxy(this.hide,this)});this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new r(this.isInput?this.element.prop("value"):this.element.data("color"));this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor()},setValue:function(n){this.color=new r(n);this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor();this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide();n(window).off("resize",this.place);this.isInput?this.element.prop("value",this.format.call(this)):(n(document).off({mousedown:this.hide}),this.component&&this.element.find("input").prop("value",this.format.call(this)),this.element.data("color",this.format.call(this)));this.element.trigger({type:"hide",color:this.color})},place:function(){var n=this.component?this.component.offset():this.element.offset();this.picker.css({top:n.top+this.height,left:n.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(n){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1);this.alpha&&(this.alpha.backgroundColor=this.color.toHex())},pointer:null,slider:null,mousedown:function(i){var f,r,u;if(i.stopPropagation(),i.preventDefault(),f=n(i.target),r=f.closest("div"),!r.is(".colorpicker")){if(r.is(".colorpicker-saturation"))this.slider=n.extend({},t.sliders.saturation);else if(r.is(".colorpicker-hue"))this.slider=n.extend({},t.sliders.hue);else if(r.is(".colorpicker-alpha"))this.slider=n.extend({},t.sliders.alpha);else return!1;u=r.offset();this.slider.knob=r.find("i")[0].style;this.slider.left=i.pageX-u.left;this.slider.top=i.pageY-u.top;this.pointer={left:i.pageX,top:i.pageY};n(document).on({mousemove:n.proxy(this.mousemove,this),mouseup:n.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(n){n.stopPropagation();n.preventDefault();var t=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((n.pageX||this.pointer.left)-this.pointer.left))),i=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((n.pageY||this.pointer.top)-this.pointer.top)));return this.slider.knob.left=t+"px",this.slider.knob.top=i+"px",this.slider.callLeft&&this.color[this.slider.callLeft].call(this.color,t/100),this.slider.callTop&&this.color[this.slider.callTop].call(this.color,i/100),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),n(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),!1}};n.fn.colorpicker=function(t,r){return this.each(function(){var f=n(this),u=f.data("colorpicker"),e=typeof t=="object"&&t;u||f.data("colorpicker",u=new i(this,n.extend({},n.fn.colorpicker.defaults,e)));typeof t=="string"&&u[t](r)})};n.fn.colorpicker.defaults={};n.fn.colorpicker.Constructor=i;t={translateFormats:{rgb:function(){var n=this.color.toRGB();return"rgb("+n.r+","+n.g+","+n.b+")"},rgba:function(){var n=this.color.toRGB();return"rgba("+n.r+","+n.g+","+n.b+","+n.a+")"},hsl:function(){var n=this.color.toHSL();return"hsl("+Math.round(n.h*360)+","+Math.round(n.s*100)+"%,"+Math.round(n.l*100)+"%)"},hsla:function(){var n=this.color.toHSL();return"hsla("+Math.round(n.h*360)+","+Math.round(n.s*100)+"%,"+Math.round(n.l*100)+"%,"+n.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},RGBtoHSB:function(n,t,i,r){n/=255;t/=255;i/=255;var e,o,f,u;return f=Math.max(n,t,i),u=f-Math.min(n,t,i),e=u===0?null:f==n?(t-i)/u:f==t?(i-n)/u+2:(n-t)/u+4,e=(e+360)%6/6,o=u===0?0:u/f,{h:e||1,s:o,b:f,a:r||1}},HueToRGB:function(n,t,i){return i<0?i+=1:i>1&&(i-=1),i*6<1?n+(t-n)*i*6:i*2<1?t:i*3<2?n+(t-n)*(2/3-i)*6:n},HSLtoRGB:function(n,i,r,u){var f;i<0&&(i=0);f=r<=.5?r*(1+i):r+i-r*i;var e=2*r-f,o=n+1/3,s=n,h=n-1/3,c=Math.round(t.HueToRGB(e,f,o)*255),l=Math.round(t.HueToRGB(e,f,s)*255),a=Math.round(t.HueToRGB(e,f,h)*255);return[c,l,a,u||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(n){return[n[1],n[2],n[3],n[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(n){return[2.55*n[1],2.55*n[2],2.55*n[3],n[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(n){return[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(n){return[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(n){return[n[1]/360,n[2]/100,n[3]/100,n[4]]}}],template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b><\/b><\/i><\/div><div class="colorpicker-hue"><i><\/i><\/div><div class="colorpicker-alpha"><i><\/i><\/div><div class="colorpicker-color"><div /><\/div><\/div>'}}(window.jQuery);