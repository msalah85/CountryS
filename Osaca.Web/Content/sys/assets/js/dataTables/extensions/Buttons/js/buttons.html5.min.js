/*!
 * HTML5 export buttons for Buttons and DataTables.
 * 2015 SpryMedia Ltd - datatables.net/license
 *
 * FileSaver.js (2015-05-07.2) - MIT license
 * Copyright © 2015 Eli Grey - http://eligrey.com
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),i.fn.dataTable.Buttons||require("datatables.net-buttons")(t,i),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var u=n.fn.dataTable,e=function(n){if(typeof navigator=="undefined"||!/MSIE [1-9]\./.test(navigator.userAgent)){var h=n.document,u=function(){return n.URL||n.webkitURL||n},i=h.createElementNS("http://www.w3.org/1999/xhtml","a"),y="download"in i,p=function(t){var i=h.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,n,0,0,0,0,0,!1,!1,!1,!1,0,null);t.dispatchEvent(i)},f=n.webkitRequestFileSystem,c=n.requestFileSystem||f||n.mozRequestFileSystem,w=function(t){(n.setImmediate||n.setTimeout)(function(){throw t;},0)},e="application/octet-stream",l=0,b=500,o=function(t){var i=function(){typeof t=="string"?u().revokeObjectURL(t):t.remove()};n.chrome?i():setTimeout(i,b)},s=function(n,t,i){var r,u;for(t=[].concat(t),r=t.length;r--;)if(u=n["on"+t[r]],typeof u=="function")try{u.call(n,i||n)}catch(f){w(f)}},a=function(n){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["﻿",n],{type:n.type}):n},v=function(t,h){t=a(t);var v=this,g=t.type,nt=!1,w,d,tt=function(){s(v,"writestart progress write writeend".split(" "))},b=function(){if((nt||!w)&&(w=u().createObjectURL(t)),d)d.location.href=w;else{var i=n.open(w,"_blank");i===r&&typeof safari!="undefined"&&(n.location.href=w)}v.readyState=v.DONE;tt();o(w)},k=function(n){return function(){if(v.readyState!==v.DONE)return n.apply(this,arguments)}},it={create:!0,exclusive:!1},rt;if(v.readyState=v.INIT,h||(h="download"),y){w=u().createObjectURL(t);i.href=w;i.download=h;p(i);v.readyState=v.DONE;tt();o(w);return}if(n.chrome&&g&&g!==e&&(rt=t.slice||t.webkitSlice,t=rt.call(t,0,t.size,e),nt=!0),f&&h!=="download"&&(h+=".download"),(g===e||f)&&(d=n),!c){b();return}l+=t.size;c(n.TEMPORARY,l,k(function(n){n.root.getDirectory("saved",it,k(function(n){var i=function(){n.getFile(h,it,k(function(n){n.createWriter(k(function(i){i.onwriteend=function(t){d.location.href=n.toURL();v.readyState=v.DONE;s(v,"writeend",t);o(n)};i.onerror=function(){var n=i.error;n.code!==n.ABORT_ERR&&b()};"writestart progress write abort".split(" ").forEach(function(n){i["on"+n]=v["on"+n]});i.write(t);v.abort=function(){i.abort();v.readyState=v.DONE};v.readyState=v.WRITING}),b)}),b)};n.getFile(h,{create:!1},k(function(n){n.remove();i()}),k(function(n){n.code===n.NOT_FOUND_ERR?i():b()}))}),b)}),b)},t=v.prototype,k=function(n,t){return new v(n,t)};return typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob?function(n,t){return navigator.msSaveOrOpenBlob(a(n),t)}:(t.abort=function(){var n=this;n.readyState=n.DONE;s(n,"abort")},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,k)}}(t),o=function(t,i){var u=t.filename==="*"&&t.title!=="*"&&t.title!==r?t.title:t.filename;return u.indexOf("*")!==-1&&(u=u.replace("*",n("title").text())),u=u.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),i===r||i===!0?u+t.extension:u},l=function(t){var i=t.title;return i.indexOf("*")!==-1?i.replace("*",n("title").text()):i},s=function(n){return n.newline?n.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},h=function(n,t){for(var f=s(t),u=n.buttons.exportData(t.exportOptions),i=t.fieldBoundary,c=t.fieldSeparator,l=new RegExp(i,"g"),a=t.escapeChar!==r?t.escapeChar:"\\",e=function(n){for(var r="",t=0,u=n.length;t<u;t++)t>0&&(r+=c),r+=i?i+(""+n[t]).replace(l,a+i)+i:n[t];return r},v=t.header?e(u.header)+f:"",y=t.footer?f+e(u.footer):"",o=[],h=0,p=u.body.length;h<p;h++)o.push(e(u.body[h]));return{str:v+o.join(f)+y,rows:o.length}},c=function(){return navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Opera")===-1},f={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><\/Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><\/Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><\/Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t<\/bookViews>\t<sheets>\t\t<sheet name="Sheet1" sheetId="1" r:id="rId1"/>\t<\/sheets><\/workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t<\/sheetData><\/worksheet>'};return u.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(n){return n.i18n("buttons.copy","Copy")},action:function(t,r,u,f){var a=h(r,f),v=a.str,e=n("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0}),o=n("<textarea readonly/>").val(v).appendTo(e),c,l,s;if(i.queryCommandSupported("copy")){e.appendTo("body");o[0].focus();o[0].select();try{i.execCommand("copy");e.remove();r.buttons.info(r.i18n("buttons.copyTitle","Copy to clipboard"),r.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},a.rows),2e3);return}catch(y){}}c=n("<span>"+r.i18n("buttons.copyKeys","Press <i>ctrl<\/i> or <i>⌘<\/i> + <i>C<\/i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"<\/span>").append(e);r.buttons.info(r.i18n("buttons.copyTitle","Copy to clipboard"),c,0);o[0].focus();o[0].select();l=n(c).closest(".dt-button-info");s=function(){l.off("click.buttons-copy");n(i).off(".buttons-copy");r.buttons.info(!1)};l.on("click.buttons-copy",s);n(i).on("keydown.buttons-copy",function(n){n.keyCode===27&&s()}).on("copy.buttons-copy cut.buttons-copy",function(){s()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1},u.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return t.FileReader!==r&&t.Blob},text:function(n){return n.i18n("buttons.csv","CSV")},action:function(n,t,r,u){var l=s(u),c=h(t,u).str,f=u.charset;f!==!1?(f||(f=i.characterSet||i.charset),f&&(f=";charset="+f)):f="";e(new Blob([c],{type:"text/csv"+f}),o(u))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1},u.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return t.FileReader!==r&&t.JSZip!==r&&!c()},text:function(n){return n.i18n("buttons.excel","Excel")},action:function(n,i,u,s){var c="",l=i.buttons.exportData(s.exportOptions),v=function(n){for(var i=[],t=0,u=n.length;t<u;t++)(n[t]===null||n[t]===r)&&(n[t]=""),i.push(typeof n[t]=="number"||n[t].match&&n[t].match(/^-?[0-9\.]+$/)&&n[t].charAt(0)!=="0"?'<c t="n"><v>'+n[t]+"<\/v><\/c>":'<c t="inlineStr"><is><t>'+(n[t].replace?n[t].replace(/&(?!amp;)/g,"&amp;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):n[t])+"<\/t><\/is><\/c>");return"<row>"+i.join("")+"<\/row>"},a,y;for(s.header&&(c+=v(l.header)),a=0,y=l.body.length;a<y;a++)c+=v(l.body[a]);s.footer&&(c+=v(l.footer));var h=new t.JSZip,p=h.folder("_rels"),w=h.folder("xl"),b=h.folder("xl/_rels"),k=h.folder("xl/worksheets");h.file("[Content_Types].xml",f["[Content_Types].xml"]);p.file(".rels",f["_rels/.rels"]);w.file("workbook.xml",f["xl/workbook.xml"]);b.file("workbook.xml.rels",f["xl/_rels/workbook.xml.rels"]);k.file("sheet1.xml",f["xl/worksheets/sheet1.xml"].replace("__DATA__",c));e(h.generate({type:"blob"}),o(s))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1},u.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return t.FileReader!==r&&t.pdfMake},text:function(n){return n.i18n("buttons.pdf","PDF")},action:function(i,r,u,f){var b=s(f),v=r.buttons.exportData(f.exportOptions),y=[],h,w,a,p;for(f.header&&y.push(n.map(v.header,function(n){return{text:typeof n=="string"?n:n+"",style:"tableHeader"}})),h=0,w=v.body.length;h<w;h++)y.push(n.map(v.body[h],function(n){return{text:typeof n=="string"?n:n+"",style:h%2?"tableBodyEven":"tableBodyOdd"}}));f.footer&&y.push(n.map(v.footer,function(n){return{text:typeof n=="string"?n:n+"",style:"tableFooter"}}));a={pageSize:f.pageSize,pageOrientation:f.orientation,content:[{table:{headerRows:1,body:y},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};f.message&&a.content.unshift({text:f.message,style:"message",margin:[0,0,0,12]});f.title&&a.content.unshift({text:l(f,!1),style:"title",margin:[0,0,0,12]});f.customize&&f.customize(a);p=t.pdfMake.createPdf(a);f.download!=="open"||c()?p.getBuffer(function(n){var t=new Blob([n],{type:"application/pdf"});e(t,o(f))}):p.open()},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"},u.Buttons});