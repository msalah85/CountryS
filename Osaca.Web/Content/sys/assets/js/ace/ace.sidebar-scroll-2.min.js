(function(n,t){function e(t,u){var e=this,it=n(window),h=n(t),s=h.find(".nav-list"),v=h.find(".sidebar-toggle").eq(0),d=h.find(".sidebar-shortcuts").eq(0),w=s.get(0),g,b,l,y;if(w){g=ace.helper.getAttrSettings(t,n.fn.ace_sidebar_scroll.defaults);this.settings=n.extend({},n.fn.ace_sidebar_scroll.defaults,u,g);b=e.settings.scroll_to_active;this.only_if_fixed=e.settings.only_if_fixed;l=h.ace_sidebar("ref");h.attr("data-sidebar-scroll","true");var nt=function(){return h.first("li.hover > .submenu").css("position")=="absolute"},a=null,c=null,o=null;this.is_scrolling=!1;y=!1;this.sidebar_fixed=r(t,"fixed");var k,rt,p=function(){var n=s.parent().offset();return e.sidebar_fixed&&(n.top-=ace.helper.scrollTop()),it.innerHeight()-n.top-(e.settings.include_toggle?0:v.outerHeight())+1},ut=function(){return w.scrollHeight},tt=function(n){if(!y&&(!e.only_if_fixed||e.sidebar_fixed)&&!nt()){if(s.wrap('<div class="nav-wrap-up" />'),e.settings.include_shortcuts&&d.length!=0&&s.parent().prepend(d),e.settings.include_toggle&&v.length!=0&&s.parent().append(v),i)s.parent().addClass("sidebar-scroll-native").css("max-height",p()),o=!0,a=c=s.parent();else if(a=s.parent().ace_scroll({size:p(),reset:!0,mouseWheelLock:!0,lockAnyway:e.settings.lock_anyway,styleClass:e.settings.scroll_style,hoverReset:!1}).closest(".ace-scroll").addClass("nav-scroll"),o=a.data("ace_scroll"),c=a.find(".scroll-content").eq(0),f&&!e.settings.include_toggle){var t=v.get(0);if(t)c.on("scroll.safari",function(){ace.helper.redraw(t)})}y=!0;n==!0&&(e.reset(),b&&e.scroll_to_active(),b=!1)}};this.scroll_to_active=function(){var n,u,t,f,r,e;if(i||o&&o.is_active())try{for(u=l.vars(),t=h.find(".nav-list"),u.minimized&&!u.collapsible?n=t.find("> .active"):(n=s.find("> .active.hover"),n.length==0&&(n=s.find(".active:not(.open)"))),f=n.outerHeight(),t=t.get(0),r=n.get(0);r!=t;)f+=r.offsetTop,r=r.parentNode;e=f-a.height();e>0&&c.scrollTop(e)}catch(v){}};this.reset=function(n){if(n===!0&&(this.sidebar_fixed=r(t,"fixed")),this.only_if_fixed&&!this.sidebar_fixed||nt()){this.disable();return}y||tt();h.addClass("sidebar-scroll");var u=l.vars(),f=!u.minimized&&!u.collapsible&&!u.horizontal&&(k=p())<(rt=w.parentNode.scrollHeight);this.is_scrolling=!0;f&&o&&(i?s.parent().addClass("sidebar-scroll-native").css("max-height",k):(o.update({size:k}),o.enable(),o.reset()));i?!f&&this.is_scrolling&&this.disable():f&&o.is_active()||this.is_scrolling&&this.disable()};this.disable=function(){this.is_scrolling=!1;o&&(i?s.parent().removeClass("sidebar-scroll-native").css("max-height",""):o.disable());h.removeClass("sidebar-scroll")};this.prehide=function(n){if(this.is_scrolling&&!l.get("minimized"))if(ut()+n<p())this.disable();else if(n<0){var t=c.scrollTop()+n;if(t<0)return;c.scrollTop(t)}};this._reset=function(n){n===!0&&(this.sidebar_fixed=r(t,"fixed"));ace.vars.webkit?setTimeout(function(){e.reset()},0):this.reset()};this.get=function(n){if(this.hasOwnProperty(n))return this[n]};this.set=function(n,t){this.hasOwnProperty(n)&&(this[n]=t)};this.ref=function(){return this};this.updateStyle=function(n){o&&!i&&o.update({styleClass:n})};h.on("hidden.ace.submenu.sidebar_scroll shown.ace.submenu.sidebar_scroll",".submenu",function(n){n.stopPropagation();l.get("minimized")||e._reset()});tt(!0)}}var u=ace.vars.touch,i=u,f=ace.vars.safari&&navigator.userAgent.match(/version\/[1-5]/i),r="getComputedStyle"in window?function(n,t){return n.offsetHeight,window.getComputedStyle(n).position==t}:function(t,i){return t.offsetHeight,n(t).css("position")==i};n(document).on("settings.ace.sidebar_scroll",function(t,i,u){n(".sidebar[data-sidebar-scroll=true]").each(function(){var e=n(this),t=e.ace_sidebar_scroll("ref"),o,f;i=="sidebar_collapsed"?(e.attr("data-sidebar-hover")=="true"&&e.ace_sidebar_hover("reset"),u==!0?t.disable():t.reset()):(i==="sidebar_fixed"||i==="navbar_fixed")&&(o=t.get("is_scrolling"),f=r(this,"fixed"),t.set("sidebar_fixed",f),f&&!o?t.reset():!f&&t.get("only_if_fixed")&&t.disable())})});n(window).on("resize.ace.sidebar_scroll",function(){n(".sidebar[data-sidebar-scroll=true]").each(function(){var t=n(this).ace_sidebar_scroll("ref"),i=r(this,"fixed");t.set("sidebar_fixed",i);t.reset()})});n.fn.ace_sidebar_scroll||(n.fn.ace_sidebar_scroll=function(i,r){var u,f=this.each(function(){var f=n(this),t=f.data("ace_sidebar_scroll"),o=typeof i=="object"&&i;t||f.data("ace_sidebar_scroll",t=new e(this,o));typeof i=="string"&&typeof t[i]=="function"&&(u=t[i](r))});return u===t?f:u},n.fn.ace_sidebar_scroll.defaults={scroll_to_active:!0,include_shortcuts:!0,include_toggle:!1,scroll_style:"",lock_anyway:!1,only_if_fixed:!0})})(window.jQuery);