(function(n,t){function r(t,i){var r=t.find(".widget-main").eq(0),o,u,f,e;if(n(window).off("resize.widget.scroll"),o=ace.vars.old_ie||ace.vars.touch,i){u=r.data("ace_scroll");u&&r.data("save_scroll",{size:u.size,lock:u.lock,lock_anyway:u.lock_anyway});f=t.height()-t.find(".widget-header").height()-10;f=parseInt(f);r.css("min-height",f);o?(u&&r.ace_scroll("disable"),r.css("max-height",f).addClass("overflow-scroll")):(u?r.ace_scroll("update",{size:f,mouseWheelLock:!0,lockAnyway:!0}):r.ace_scroll({size:f,mouseWheelLock:!0,lockAnyway:!0}),r.ace_scroll("enable").ace_scroll("reset"));n(window).on("resize.widget.scroll",function(){var n=t.height()-t.find(".widget-header").height()-10;n=parseInt(n);r.css("min-height",n);o?r.css("max-height",n).addClass("overflow-scroll"):r.ace_scroll("update",{size:n}).ace_scroll("reset")})}else r.css("min-height",""),e=r.data("save_scroll"),e&&r.ace_scroll("update",{size:e.size,mouseWheelLock:e.lock,lockAnyway:e.lock_anyway}).ace_scroll("enable").ace_scroll("reset"),o?r.css("max-height","").removeClass("overflow-scroll"):e||r.ace_scroll("disable")}var i=function(t){this.$box=n(t);var i=this;this.reload=function(){var n=this.$box,t=!1;n.css("position")=="static"&&(t=!0,n.addClass("position-relative"));n.append('<div class="widget-box-overlay"><i class="'+ace.vars.icon+'loading-icon fa fa-spinner fa-spin fa-2x white"><\/i><\/div>');n.one("reloaded.ace.widget",function(){n.find(".widget-box-overlay").remove();t&&n.removeClass("position-relative")})};this.closeFast=function(){this.close(0)};this.close=function(n){var t=this.$box,n=typeof n=="undefined"?300:n;t.fadeOut(n,function(){t.trigger("closed.ace.widget");t.remove()})};this.toggleFast=function(){this.toggle(null,null,0,0)};this.toggle=function(n,t,i,r){var f=this.$box,s=f.find(".widget-body").eq(0),u=null,c=n||(f.hasClass("collapsed")?"show":"hide"),l=c=="show"?"shown":"hidden",h,e,o,i,r;t||(t=f.find("> .widget-header a[data-action=collapse]").eq(0),t.length==0&&(t=null));t&&(u=t.find(ace.vars[".icon"]).eq(0),e=null,o=null,(e=u.attr("data-icon-show"))?o=u.attr("data-icon-hide"):(h=u.attr("class").match(/fa\-(.*)\-(up|down)/))&&(e="fa-"+h[1]+"-down",o="fa-"+h[1]+"-up"));i=typeof i=="undefined"?250:i;r=typeof r=="undefined"?200:r;c=="show"?(u&&u.removeClass(e).addClass(o),s.hide(),f.removeClass("collapsed"),s.slideDown(i,function(){f.trigger(l+".ace.widget")})):(u&&u.removeClass(o).addClass(e),s.slideUp(r,function(){f.addClass("collapsed");f.trigger(l+".ace.widget")}))};this.hide=function(){this.toggle("hide")};this.show=function(){this.toggle("show")};this.fullscreen=function(){var n=this.$box.find("> .widget-header a[data-action=fullscreen]").find(ace.vars[".icon"]).eq(0),t=null,i=null;(t=n.attr("data-icon1"))?i=n.attr("data-icon2"):(t="fa-expand",i="fa-compress");this.$box.hasClass("fullscreen")?(n.addClass(t).removeClass(i),this.$box.removeClass("fullscreen"),r(this.$box,!1)):(n.removeClass(t).addClass(i),this.$box.addClass("fullscreen"),r(this.$box,!0));this.$box.trigger("fullscreened.ace.widget")}};n.fn.widget_box=function(r,u){var f,e=this.each(function(){var e=n(this),t=e.data("widget_box"),o=typeof r=="object"&&r;t||e.data("widget_box",t=new i(this,o));typeof r=="string"&&(f=t[r](u))});return f===t?e:f};n(document).on("click.ace.widget",".widget-header a[data-action]",function(t){var o,r,f,e,s,u;if(t.preventDefault(),o=n(this),r=o.closest(".widget-box"),r.length!=0&&!r.hasClass("ui-sortable-helper"))if(f=r.data("widget_box"),f||r.data("widget_box",f=new i(r.get(0))),e=o.data("action"),e=="collapse"){if(s=r.hasClass("collapsed")?"show":"hide",r.trigger(u=n.Event(s+".ace.widget")),u.isDefaultPrevented())return;f.toggle(s,o)}else if(e=="close"){if(r.trigger(u=n.Event("close.ace.widget")),u.isDefaultPrevented())return;f.close()}else if(e=="reload"){if(o.blur(),r.trigger(u=n.Event("reload.ace.widget")),u.isDefaultPrevented())return;f.reload()}else if(e=="fullscreen"){if(r.trigger(u=n.Event("fullscreen.ace.widget")),u.isDefaultPrevented())return;f.fullscreen()}else e=="settings"&&r.trigger("setting.ace.widget")})})(window.jQuery);