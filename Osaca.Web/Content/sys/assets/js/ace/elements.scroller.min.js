(function(n,t){var i=function(t,i){function ai(n){n.preventDefault();n.stopPropagation();var u=r.offset(),t=u[g],i=f?n.pageY:n.pageX;i>t+e?(e=i-t-rt+dt,e>d&&(e=d)):(e=i-t-dt,e<0&&(e=0));h.update_scroll()}function vi(t){t.preventDefault();t.stopPropagation();a=f?p=t.pageY:p=t.pageX;ot=!0;n("html").off("mousemove.ace_scroll").on("mousemove.ace_scroll",yi);n(gt).off("mouseup.ace_scroll").on("mouseup.ace_scroll",pi);r.addClass("active");vt&&h.$element.trigger("drag.start")}function yi(n){n.preventDefault();n.stopPropagation();a=f?n.pageY:n.pageX;a-p+e>d?a=p+d-e:a-p+e<0&&(a=p-e);e=e+(a-p);p=a;e<0?e=0:e>d&&(e=d);h.update_scroll()}function pi(t){t.preventDefault();t.stopPropagation();ot=!1;n("html").off(".ace_scroll");n(gt).off(".ace_scroll");r.removeClass("active");vt&&h.$element.trigger("drag.end");v&&st&&!pt&&ri()}function bt(n){var i=+new Date,t;wt&&i-ii>1e3&&(t=s[nt],ti!=t&&(ti=t,it=!0,h.reset(!0)),ii=i);v&&st&&(l!=null&&(clearTimeout(l),l=null),r.addClass("not-idle"),pt||n!=!0||ri())}function ri(){l!=null&&(clearTimeout(l),l=null);l=setTimeout(function(){l=null;r.removeClass("not-idle")},ni)}function ui(){r.css("visibility","hidden").addClass("scroll-hover");b=f?parseInt(r.outerWidth())||0:parseInt(r.outerHeight())||0;r.css("visibility","").removeClass("scroll-hover")}function hi(){if(yt!==!1){var i=o.offset(),n=i.left,t=i.top;f?lt||(n+=o.outerWidth()-b):lt||(t+=o.outerHeight()-b);yt===!0?r.css({top:parseInt(t),left:parseInt(n)}):yt==="left"?r.css("left",parseInt(n)):yt==="top"&&r.css("top",parseInt(t))}}var h=this,ci=ace.helper.getAttrSettings(t,n.fn.ace_scroll.defaults),u=n.extend({},n.fn.ace_scroll.defaults,i,ci),p,a,l,ii;this.size=0;this.lock=!1;this.lock_anyway=!1;this.$element=n(t);this.element=t;var f=!0,w=!1,v=!1,ht=!1,o=null,s=null,r=null,kt=null,fi=null,ei=null,k=null,rt=0,e=0,d=0,dt=0,ct=!0,oi=!1,y="",lt=!1,b=0,g,ut,ft,si,c,nt,et=1,at=!1,ot=!1,gt="onmouseup"in window?window:"html",vt=u.dragEvent||!1,li=i.scrollEvent||!1,tt=u.detached||!1,yt=u.updatePos||!1,st=u.hideOnIdle||!1,ni=u.hideDelay||1500,pt=!1,wt=u.observeContent||!1,ti=0,it=!0;return this.ref=function(){return this},this.create=function(t){var a,l,i,p;if(!ht){t&&(u=n.extend({},n.fn.ace_scroll.defaults,t));this.size=parseInt(this.$element.attr("data-size"))||u.size||200;f=!u.horizontal;g=f?"top":"left";ut=f?"height":"width";ft=f?"maxHeight":"maxWidth";si=f?"clientHeight":"clientWidth";c=f?"scrollTop":"scrollLeft";nt=f?"scrollHeight":"scrollWidth";this.$element.addClass("ace-scroll");this.$element.css("position")=="static"?(at=this.element.style.position,this.element.style.position="relative"):at=!1;a=null;tt?a=n('<div class="scroll-track scroll-detached"><div class="scroll-bar"><\/div><\/div>').appendTo("body"):(this.$element.wrapInner('<div class="scroll-content" />'),this.$element.prepend('<div class="scroll-track"><div class="scroll-bar"><\/div><\/div>'));o=this.$element;tt||(o=this.$element.find(".scroll-content").eq(0));f||o.wrapInner("<div />");s=o.get(0);tt?(r=a,hi()):r=this.$element.find(".scroll-track").eq(0);kt=r.find(".scroll-bar").eq(0);fi=r.get(0);ei=kt.get(0);k=ei.style;f||r.addClass("scroll-hz");u.styleClass&&(y=u.styleClass,r.addClass(y),lt=!!y.match(/scroll\-left|scroll\-top/));b==0&&(r.show(),ui());r.hide();r.on("mousedown",ai);kt.on("mousedown",vi);o.on("scroll",function(){ct&&(e=parseInt(Math.round(this[c]*et)),k[g]=e+"px");ct=!1;li&&this.$element.trigger("scroll",[s])});if(u.mouseWheel){this.lock=u.mouseWheelLock;this.lock_anyway=u.lockAnyway;this.$element.on(!n.event.special.mousewheel?"mousewheel.ace_scroll DOMMouseScroll.ace_scroll":"mousewheel.ace_scroll",function(t){var i;if(!w){if(bt(!0),!v)return!h.lock_anyway;ot&&(ot=!1,n("html").off(".ace_scroll"),n(gt).off(".ace_scroll"),vt&&h.$element.trigger("drag.end"));t.deltaY=t.deltaY||0;var u=t.deltaY>0||t.originalEvent.detail<0||t.originalEvent.wheelDelta>0?1:-1,f=!1,e=s[si],r=s[c];return h.lock||(f=u==-1?s[nt]<=r+e:r==0),h.move_bar(!0),i=parseInt(e/8),i<80&&(i=80),i>h.size&&(i=h.size),i+=1,s[c]=r-u*i,f&&!h.lock_anyway}})}if(l=ace.vars.touch&&"ace_drag"in n.event.special&&u.touchDrag,l){i="";p=l?"ace_drag":"swipe";this.$element.on(p+".ace_scroll",function(n){if(w){n.retval.cancel=!0;return}if(bt(!0),!v){n.retval.cancel=this.lock_anyway;return}if(i=n.direction,f&&(i=="up"||i=="down")||!f&&(i=="left"||i=="right")){var t=f?n.dy:n.dx;t!=0&&(Math.abs(t)>20&&l&&(t=t*2),h.move_bar(!0),s[c]=s[c]+t)}})}if(st&&r.addClass("idle-hide"),wt)r.on("mouseenter.ace_scroll",function(){pt=!0;bt(!1)}).on("mouseleave.ace_scroll",function(){pt=!1;ot==!1&&ri()});this.$element.on("mouseenter.ace_scroll touchstart.ace_scroll",function(){it=!0;wt?bt(!0):u.hoverReset&&h.reset(!0);r.addClass("scroll-hover")}).on("mouseleave.ace_scroll touchend.ace_scroll",function(){r.removeClass("scroll-hover")});f||o.children(0).css(ut,this.size);o.css(ft,this.size);w=!1;ht=!0}},this.is_active=function(){return v},this.is_enabled=function(){return!w},this.move_bar=function(n){ct=n},this.get_track=function(){return fi},this.reset=function(n){var i,l,h,t;if(!w&&(ht||this.create(),i=this.size,!n||it)){if(it=!1,tt&&(l=parseInt(Math.round((parseInt(o.css("border-top-width"))+parseInt(o.css("border-bottom-width")))/2.5)),i-=l),h=f?s[nt]:i,f&&h==0||!f&&this.element.scrollWidth==0){r.removeClass("scroll-active");return}t=f?i:s.clientWidth;f||o.children(0).css(ut,i);o.css(ft,this.size);h>t?(v=!0,r.css(ut,t).show(),et=parseFloat((t/h).toFixed(5)),rt=parseInt(Math.round(t*et)),dt=parseInt(Math.round(rt/2)),d=t-rt,e=parseInt(Math.round(s[c]*et)),k[ut]=rt+"px",k[g]=e+"px",r.addClass("scroll-active"),b==0&&ui(),oi||(u.reset&&(s[c]=0,k[g]=0),oi=!0),tt&&hi()):(v=!1,r.hide(),r.removeClass("scroll-active"),o.css(ft,""));return}},this.disable=function(){s[c]=0;k[g]=0;w=!0;v=!1;r.hide();this.$element.addClass("scroll-disabled");r.removeClass("scroll-active");o.css(ft,"")},this.enable=function(){w=!1;this.$element.removeClass("scroll-disabled")},this.destroy=function(){v=!1;w=!1;ht=!1;this.$element.removeClass("ace-scroll scroll-disabled scroll-active");this.$element.off(".ace_scroll");tt||(f||o.find("> div").children().unwrap(),o.children().unwrap(),o.remove());r.remove();at!==!1&&(this.element.style.position=at);l!=null&&(clearTimeout(l),l=null)},this.modify=function(t){t&&(u=n.extend({},u,t));this.destroy();this.create();it=!0;this.reset(!0)},this.update=function(t){t&&(u=n.extend({},u,t));this.size=u.size||this.size;this.lock=u.mouseWheelLock||this.lock;this.lock_anyway=u.lockAnyway||this.lock_anyway;st=u.hideOnIdle||st;ni=u.hideDelay||ni;wt=u.observeContent||!1;vt=u.dragEvent||!1;typeof t.styleClass!="undefined"&&(y&&r.removeClass(y),y=t.styleClass,y&&r.addClass(y),lt=!!y.match(/scroll\-left|scroll\-top/))},this.start=function(){s[c]=0},this.end=function(){s[c]=s[nt]},this.hide=function(){r.hide()},this.show=function(){r.show()},this.update_scroll=function(){ct=!1;k[g]=e+"px";s[c]=parseInt(Math.round(e/et))},p=-1,a=-1,l=null,ii=0,this.track_size=function(){return b==0&&ui(),b},this.create(),it=!0,this.reset(!0),ti=s[nt],this};n.fn.ace_scroll=function(r,u){var f,e=this.each(function(){var e=n(this),t=e.data("ace_scroll"),o=typeof r=="object"&&r;t||e.data("ace_scroll",t=new i(this,o));typeof r=="string"&&(f=t[r](u))});return f===t?e:f};n.fn.ace_scroll.defaults={size:200,horizontal:!1,mouseWheel:!0,mouseWheelLock:!1,lockAnyway:!1,styleClass:!1,observeContent:!1,hideOnIdle:!1,hideDelay:1500,hoverReset:!0,reset:!1,dragEvent:!1,touchDrag:!0,touchSwipe:!1,scrollEvent:!1,detached:!1,updatePos:!0}})(window.jQuery);